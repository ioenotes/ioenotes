{{ define "main" }}
  <section class="section-sm">
    <div class="container">
      <div class="row justify-center">
        <div class="md:col-10 lg:col-7">
          {{ partial "components/breadcrumb.html" (dict "Context" . "Class" "mb-6") }}
          <div class="w-full aspect-[3/1] mb-6">
            <img src="{{ .Params.image | relURL }}" alt="{{ .Title }}" class="w-full h-full object-cover grayscale">
          </div>
          {{ if .Params.subject }}
            <div class="mb-2">
              <h2 class="h3 inline-block">{{ .Params.subject }}</h2>
              {{ if .Params.subject_code }}
                <span class="ml-2 bg-primary text-white px-3 py-1 rounded font-medium">{{ .Params.subject_code }}</span>
              {{ end }}
            </div>            {{/* Extract faculty, year, and part from URL structure */}}
            {{ $sections := split (trim .RelPermalink "/") "/" }}
            {{ $faculty := "" }}
            {{ $yearpart := "" }}
            
            {{ if ge (len $sections) 2 }}
              {{ $faculty = index $sections 1 | title }}
            {{ end }}              {{ if ge (len $sections) 3 }}
              {{ $yearPart := index $sections 2 }}
              {{ if findRE `year(\d+)-part(\d+)` $yearPart }}
                {{ $yearNum := replaceRE `year(\d+)-part(\d+)` "$1" $yearPart }}
                {{ $partNum := replaceRE `year(\d+)-part(\d+)` "$2" $yearPart }}
                  <!-- Convert to Roman numerals -->
                {{ $yearRoman := cond (eq $yearNum "1") "I" (cond (eq $yearNum "2") "II" (cond (eq $yearNum "3") "III" (cond (eq $yearNum "4") "IV" (cond (eq $yearNum "5") "V" "")))) }}
                {{ $partRoman := cond (eq $partNum "1") "I" (cond (eq $partNum "2") "II" "") }}
                
                {{ $yearpart = printf "[%s/%s]" $yearRoman $partRoman }}
              {{ else }}
                {{ $yearpart = replace $yearPart "-" " " | title }}
              {{ end }}
            {{ end }}
            
            {{ $syllabus := printf "%s %s Syllabus" $faculty $yearpart }}
            <h3 class="text-lg text-gray-700 mb-6">{{ $syllabus }}</h3>
          {{ else }}
            <h2 class="h3 mb-6">{{ .Title }}</h2>
          {{ end }}
          <div class="content">{{ .Content }}</div>
          <div class="mt-8">
            {{ partial "contribution-section.html" . }}
          </div>
        </div>
      </div>
    </div>
  </section>
{{ end }}
